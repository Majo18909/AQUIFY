<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQUIFY - Tu Compa√±ero Musical para el Ba√±o</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <img src="{{ url_for('static', filename='img/aquify-logo.png') }}" alt="AQUIFY Logo" class="logo-img"
                onerror="this.style.display='none'">
            <h1>AQUIFY</h1>
        </div>
        <p>Tu Compa√±ero Musical para el Ba√±o üíß</p>
    </header>

    <!-- Container Principal -->
    <div class="container">
        <!-- Tabs de Navegaci√≥n -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('perfil')">
                üë§ Perfil
            </button>
            <button class="tab-button" onclick="switchTab('musica')">
                üéµ M√∫sica
            </button>
            <button class="tab-button" onclick="switchTab('chatbot')">
                ü§ñ Asistente
            </button>
            <button class="tab-button" onclick="switchTab('reproductor')">
                ‚ñ∂Ô∏è Reproductor
            </button>
            <button class="tab-button" onclick="switchTab('temporizador')">
                ‚è±Ô∏è Temporizador
            </button>
        </div>

        <!-- Tab: Perfil de Usuario -->
        <div id="tab-perfil" class="tab-content active">
            <h2>üë§ Perfil de Usuario</h2>

            <div id="perfil-display" style="display: none;">
                <div class="profile-display">
                    <h3>Tu Perfil</h3>
                    <div id="perfil-info"></div>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="btn btn-secondary" onclick="editarPerfil()">Editar Perfil</button>
                        <button class="btn" style="background: #dc3545; color: white;"
                            onclick="limpiarPerfilLocal()">Borrar Perfil del Dispositivo</button>
                    </div>
                    <p style="color: #666; font-size: 0.85rem; margin-top: 0.5rem;">üíæ Tu perfil est√° guardado en este
                        dispositivo</p>
                </div>
            </div>

            <div id="perfil-form">
                <div class="card">
                    <h3>Crear/Editar Perfil</h3>

                    <div class="form-group">
                        <label>G√©nero</label>
                        <select id="genero" onchange="toggleGeneroPersonalizado()">
                            <option value="Hombre">Hombre</option>
                            <option value="Mujer">Mujer</option>
                            <option value="Personalizado">Personalizado</option>
                            <option value="Prefiero no decirlo">Prefiero no decirlo</option>
                        </select>
                    </div>

                    <div id="genero-personalizado" class="custom-gender">
                        <div class="form-group">
                            <label>Especifica tu g√©nero</label>
                            <input type="text" id="genero-custom" placeholder="Tu g√©nero">
                        </div>
                        <div class="form-group">
                            <label>Pronombres preferidos</label>
                            <input type="text" id="pronombres" placeholder="Ej: √©l/ella/elle">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Edad</label>
                        <input type="number" id="edad" min="1" max="120" placeholder="Tu edad">
                    </div>

                    <div class="form-group">
                        <label>Tipo de Piel</label>
                        <select id="tipo-piel">
                            <option value="Normal">Normal</option>
                            <option value="Seca">Seca</option>
                            <option value="Mixta">Mixta</option>
                            <option value="Grasa">Grasa</option>
                            <option value="Sensible">Sensible</option>
                            <option value="No s√©">No s√©</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" onclick="guardarPerfil()">Guardar Perfil</button>
                </div>
            </div>
        </div>

        <!-- Tab: Gesti√≥n de M√∫sica -->
        <div id="tab-musica" class="tab-content">
            <h2>üéµ Gesti√≥n de M√∫sica</h2>

            <div class="card" id="vercel-warning"
                style="display: none; background: #fff3cd; border-left: 4px solid #ffc107;">
                <h3 style="color: #856404;">‚ö†Ô∏è Limitaci√≥n en Vercel</h3>
                <p style="color: #856404;"><strong>Archivos m√°ximo 4MB en Vercel</strong> (l√≠mite del plan gratuito). El
                    almacenamiento tambi√©n es temporal.</p>
                <ul style="color: #856404;">
                    <li><strong>Para archivos m√°s grandes o permanentes:</strong></li>
                    <li>‚úÖ Ejecuta la app localmente (localhost) - hasta 50MB</li>
                    <li>‚úÖ Despliega en Render.com - almacenamiento persistente</li>
                    <li>‚ö° En Vercel: usa solo archivos peque√±os (menos de 4MB) para demostraci√≥n</li>
                </ul>
            </div>

            <div class="card" id="upload-card">
                <h3>Subir Canci√≥n</h3>
                <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
                    <p style="font-size: 3rem; margin-bottom: 1rem;">üìÅ</p>
                    <p style="font-size: 1.2rem; margin-bottom: 0.5rem;">Haz clic o arrastra archivos aqu√≠</p>
                    <p style="color: #666;" id="upload-info">Formatos: MP3, WAV, OGG, FLAC, M4A (M√°x. 50MB)</p>
                    <input type="file" id="file-input" accept=".mp3,.wav,.ogg,.flac,.m4a" style="display: none;"
                        onchange="subirCancion()">
                </div>
            </div>

            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h3>Tu Playlist</h3>
                    <button class="btn"
                        style="background: #dc3545; color: white; font-size: 0.85rem; padding: 0.4rem 0.8rem;"
                        onclick="limpiarCancionesLocales()">üóëÔ∏è Limpiar del Dispositivo</button>
                </div>
                <ul id="song-list" class="song-list"></ul>
                <p id="canciones-local-info"
                    style="color: #666; font-size: 0.85rem; margin-top: 0.5rem; display: none;">
                    üíæ Tus canciones est√°n guardadas en este dispositivo</p>
            </div>
        </div>

        <!-- Tab: Chatbot Asistente -->
        <div id="tab-chatbot" class="tab-content">
            <h2>ü§ñ Asistente AQUIFY</h2>

            <div class="card">
                <h3>üí¨ Chat Interactivo</h3>
                <div id="chat-container" class="chat-container">
                    <div id="chat-messages" class="chat-messages">
                        <div class="chat-message bot-message">
                            <strong>AQUIFY:</strong>
                            <p>¬°Hola! üëã Soy tu asistente personal. Puedo ayudarte con:</p>
                            <ul>
                                <li>üß¥ Rutinas de cuidado de la piel</li>
                                <li>üíÑ Recomendaciones de productos</li>
                                <li>üéµ Sugerencias de m√∫sica para tu ducha</li>
                                <li>üìö Informaci√≥n de fuentes confiables sobre cuidado de la piel</li>
                            </ul>
                            <p>¬øEn qu√© puedo ayudarte?</p>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" class="chat-input" placeholder="Escribe tu pregunta aqu√≠..."
                            onkeypress="if(event.key==='Enter') enviarMensaje()">
                        <button class="btn btn-primary" onclick="enviarMensaje()">Enviar</button>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 1rem;">
                <h3>üìã Acciones R√°pidas</h3>
                <div class="tabs">
                    <button class="btn btn-secondary" onclick="mostrarRutina()">Ver Mi Rutina</button>
                    <button class="btn btn-secondary" onclick="mostrarConsejos()">Consejos</button>
                    <button class="btn btn-secondary" onclick="mostrarRecomendaciones()">Recomendaciones
                        Musicales</button>
                </div>
            </div>

            <div id="chatbot-response"></div>
        </div>

        <!-- Tab: Reproductor -->
        <div id="tab-reproductor" class="tab-content">
            <h2>‚ñ∂Ô∏è Reproductor de M√∫sica</h2>

            <div class="card">
                <h3>Selecciona una Canci√≥n</h3>
                <select id="cancion-seleccionada" class="form-group">
                    <option value="">-- Selecciona una canci√≥n --</option>
                </select>
            </div>

            <div class="card">
                <h3>Modo de Reproducci√≥n</h3>
                <div class="form-group">
                    <label>
                        <input type="radio" name="modo" value="rutina" checked onchange="toggleTiempoRutina()">
                        Con Rutina (se pausa autom√°ticamente)
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="radio" name="modo" value="libre" onchange="toggleTiempoRutina()">
                        Reproducci√≥n Libre
                    </label>
                </div>

                <div id="tiempo-rutina-container" class="form-group">
                    <label>Tiempo de rutina (minutos)</label>
                    <input type="number" id="tiempo-rutina" min="1" max="60" value="7">
                    <p style="font-size: 0.85em; color: #666; margin-top: 5px;">üí° El tiempo se ajusta autom√°ticamente
                        seg√∫n tu perfil</p>
                </div>

                <button class="btn btn-primary" onclick="iniciarReproduccion()">‚ñ∂Ô∏è Reproducir</button>
            </div>

            <!-- Player -->
            <div id="player-container" style="display: none;">
                <div class="player">
                    <div class="player-info">
                        <h3 id="player-song-name">-</h3>
                        <p id="player-mode">-</p>
                    </div>

                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>

                    <div class="player-controls">
                        <button onclick="pausarReproduccion()" id="btn-pause">‚è∏Ô∏è</button>
                        <button onclick="reanudarReproduccion()" id="btn-play" style="display: none;">‚ñ∂Ô∏è</button>
                        <button onclick="detenerReproduccion()">‚èπÔ∏è</button>
                    </div>

                    <div class="timer-display" id="timer-display">00:00</div>

                    <audio id="audio-player" loop></audio>
                </div>
            </div>
        </div>

        <!-- Tab: Temporizador -->
        <div id="tab-temporizador" class="tab-content">
            <h2>‚è±Ô∏è Temporizador</h2>

            <div class="card">
                <h3>Configurar Temporizador</h3>
                <p style="color: #666; font-size: 0.9rem; margin-bottom: 1rem;">
                    üí° El tiempo se ajusta autom√°ticamente seg√∫n tu perfil
                </p>
                <div class="timer-control">
                    <div class="form-group">
                        <label>Tiempo (minutos)</label>
                        <input type="number" id="timer-minutes" class="timer-input" min="1" max="60" value="7">
                    </div>
                    <button class="btn btn-primary" onclick="iniciarTemporizador()">‚ñ∂Ô∏è Iniciar</button>
                </div>
            </div>

            <div id="timer-active" style="display: none;">
                <div class="player">
                    <div class="timer-display" id="standalone-timer">05:00</div>
                    <div class="player-controls">
                        <button onclick="detenerTemporizador()">‚èπÔ∏è Detener</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- √Årea de alertas -->
    <div id="alert-container" style="position: fixed; top: 20px; right: 20px; z-index: 1000; max-width: 400px;"></div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>